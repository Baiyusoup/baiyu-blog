---
title: 从输入 URL 到页面加载完成的过程中都发生了什么？
date: 2021-04-03
categories:
 - 浏览器
author: 青菜白玉汤
---

## 流程
1. 浏览器查找DNS缓存中是否由对应ip地址，如果没有就进行第二步
2. 浏览器去操作系统中查找DNS缓存中是否有对应的ip地址，如果没有就进行第三步
3. 浏览器向本地的DNS服务器进行递归查询，如果本地DNS服务没有，那么本地DNS服务器就对跟服务器迭代查询
4. 根据查到的IP地址对目标服务器建立TCP连接（三次握手）
5. 浏览器发出HTTP请求，该请求将作为TCP三次握手的第三个报文数据发送给服务器
6. 服务器对浏览器请求做出响应，并将响应数据发送给浏览器
7. 浏览器对接收到的响应报文进行处理（浏览器解析渲染）
8. 释放TCP连接（四次挥手）


## 三次握手和四次挥手

## 浏览器解析过程
[源](https://github.com/okaychen/FE-Interview-Brochure/blob/master/html-and-css.md#htmlcss)

1. HTML Parser将HTML文件解析成DOM树
   1. 在这过程遇到script标签会停止解析文档，立即解析脚本
2. CSS Parser将CSS解析成CSSOM树
3. 根据DOM树和CSSOM树构建render树
4. 根据render树进行布局渲染render layer
5. 根据计算的布局信息进行绘制

## 回流/重绘
`回流`：当前窗口发生改变、滚动操作或元素的位置大小相关属性被更新时会触发布局过程，发生在render树

`重绘`：指当前视觉样式属性被更新时触发的绘制过程，发生在render layer

### 减少回流重绘次数
1. 采用修改className或者style.classText，而不是一条一条地修改DOM样式
2. 对于一个元素进行复杂的操作，可以先隐藏它，操作完成后再显示
3. 对需要经常获取那些引起浏览器回流的属性值时，要缓存到变量中
4. 不使用table布局，因为table布局里一个小改动就可能会引起整个table重新布局
5. 在内存中多次操作节点，完成后再添加到文档中