---
title: 三次握手与四次挥手
date: 2021-04-12
categories:
 - 计算机网络
author: 青菜白玉汤
tags:
 - TCP
---

### 三次握手

`第一次握手`：客户端将请求报文首部的SYN置1，seq=x，然后发送，此时客户端进入同步以发送状态

`第二次握手`：服务端接收到报文后，将确认报文段中的SYN和ACK位都置1，设置确认号ack = x + 1，同时也选择一个初始序号seq = y，然后服务器进入同步收到状态

`第三次握手`：客户端收到确认报文后，向服务器发送确认报文，将报文段中ACK置1，确认号ack = y + 1，设置seq = x + 1，此时客户端进入已连接状态，服务端收到确认报文后，也进入已连接状态，此时可以进行数据转送

`客户端最后的确认是防止已经失效的连接请求报文段突然又传送到了服务端，因此产生错误`

### 四次挥手

`第一次挥手`：客户端将报文字段首部的终止控制位FIN置1，设置seq = u

`第二次挥手`：服务端收到连接释放报文后，将ACK=1, 确认号ack=u+1，seq = v，之后TCP连接处于半关闭状态

`第三次挥手`：服务端将FIN置1，ack = u + 1, seq = w， ACK = 1

`第四次挥手`：客户端在确认报文中把ACK置1，确认号ack = u + 1, seq = w + 1